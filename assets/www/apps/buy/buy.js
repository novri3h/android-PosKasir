!function(){"use strict";function a(a,b,c,d){function e(a){var b=".",c=",",d="";a+="",a=a.replace(new RegExp(",","g"),"");for(var e=a.split(b),f=e[0].split("").reverse(),g=Array(),h=0;h<f.length;h++)g[g.length]=h%3===2&&h<f.length-1?c+f[h]:f[h];var i=g.reverse().join("");return a.indexOf(b)>=0&&parseInt(e[1])&&(i+=b+e[1]),d=i}function f(a){var b="0";a+="",a=a.replace(new RegExp(" ","g"),"");var c=a.split(".");if(c.length>1){var d=c[0].replace(new RegExp(",","g"),""),e=c[1].replace(new RegExp(",","g"),"");b=parseInt(e)?d+"."+e:d}else b=a.replace(new RegExp(",","g"),"");return b.length<1&&(b="0"),b}function g(a){var b="";a+="",a=a.replace(new RegExp(" ","g"),"");var c=a.split(".");if(c.length>1){var d=c[0],e=c[1].replace(new RegExp(",","g"),"");b=parseInt(e)?d+"."+e:d}else b=a;return b}function h(a){var b="";a+="",a=a.replace(new RegExp(" ","g"),"");var c=a.split(".");if(c.length>1){var d=c[0];b=d}else b=a;return b}function i(){ua.categoryLoading=!0,$.ajax({context:b,type:"GET",url:va+"category_list/",dataType:"json",data:{last_count:ua.categorys.length},success:function(a){ua.categoryLoading=!1,a.categorys&&a.categorys.forEach(function(a){if(ua.categorys.length){var b=_.findIndex(ua.categorys,function(b){return b.category_uxid==a.category_uxid});-1===b?ua.categorys.push(a):ua.categorys[b]=a}else ua.categorys.push(a)}),ua.$apply()},complete:function(){ua.categoryLoading=!1,ua.$apply()},error:function(){ua.categoryLoading=!1,ua.$apply()}})}function j(a){angular.forEach(ua.categorys,function(a){a.selected=!1}),ua.category=a,ua.category.selected=!0,ua.productSearch="",ua.categoryNameSelected=a.category_name}function k(){ua.productSearch="",""==ua.categoryNameSelected?l():ua.categoryNameSelected=""}function l(){ua.productEmpty=!1,(void 0!==ua.categoryNameSelected||null!==ua.categoryNameSelected)&&(ua.categoryNameSelected.length?ua.productSearch.length?(ua.products=[],q()):(ua.products=[],o()):ua.productSearch.length?(ua.products=[],p(),angular.forEach(ua.categorys,function(a){a.selected=!1})):(ua.products=[],n(),angular.forEach(ua.categorys,function(a){a.selected=!1})))}function m(){ua.productEmpty=!1,(void 0!==ua.categoryNameSelected||null!==ua.categoryNameSelected)&&(ua.categoryNameSelected.length?ua.productSearch.length?q():o():ua.productSearch.length?(p(),angular.forEach(ua.categorys,function(a){a.selected=!1})):(n(),angular.forEach(ua.categorys,function(a){a.selected=!1})))}function n(){ua.productLoading=!0,$.ajax({context:b,type:"GET",url:va+"product_buy_list/",dataType:"json",data:{last_count:ua.products.length},success:function(a){ua.productLoading=!1,a.products&&a.products.forEach(function(a){if(ua.products.length){var b=_.findIndex(ua.products,function(b){return b.product_uxid==a.product_uxid});-1===b?ua.products.push(a):ua.products[b]=a}else ua.products.push(a)}),ua.products.length?ua.productEmpty=!1:ua.productEmpty=!0,ua.$apply()},complete:function(){ua.productLoading=!1,ua.$apply()},error:function(){ua.productLoading=!1,ua.$apply()}})}function o(){ua.productLoading=!0,$.ajax({context:b,type:"GET",url:va+"product_buy_list/",dataType:"json",data:{last_count:ua.products.length,category_name:ua.categoryNameSelected},success:function(a){ua.productLoading=!1,a.products&&a.products.forEach(function(a){if(ua.products.length){var b=_.findIndex(ua.products,function(b){return b.product_uxid==a.product_uxid});-1===b?ua.products.push(a):ua.products[b]=a}else ua.products.push(a)}),ua.products.length?ua.productEmpty=!1:ua.productEmpty=!0,ua.$apply()},complete:function(){ua.productLoading=!1,ua.$apply()},error:function(){ua.productLoading=!1,ua.$apply()}})}function p(){ua.productLoading=!0,$.ajax({context:b,type:"GET",url:va+"product_buy_search/",dataType:"json",data:{last_count:ua.products.length,search:ua.productSearch},success:function(a){ua.productLoading=!1,a.products&&a.products.forEach(function(a){if(ua.products.length){var b=_.findIndex(ua.products,function(b){return b.product_uxid==a.product_uxid});-1===b?ua.products.push(a):ua.products[b]=a}else ua.products.push(a)}),ua.products.length?ua.productEmpty=!1:ua.productEmpty=!0,ua.$apply()},complete:function(){ua.productLoading=!1,ua.$apply()},error:function(){ua.productLoading=!1,ua.$apply()}})}function q(){ua.productLoading=!0,$.ajax({context:b,type:"GET",url:va+"product_buy_search/",dataType:"json",data:{last_count:ua.products.length,category_name:ua.categoryNameSelected,search:ua.productSearch},success:function(a){ua.productLoading=!1,a.products&&a.products.forEach(function(a){if(ua.products.length){var b=_.findIndex(ua.products,function(b){return b.product_uxid==a.product_uxid});-1===b?ua.products.push(a):ua.products[b]=a}else ua.products.push(a)}),ua.products.length?ua.productEmpty=!1:ua.productEmpty=!0,ua.$apply()},complete:function(){ua.productLoading=!1,ua.$apply()},error:function(){ua.productLoading=!1,ua.$apply()}})}function r(a){angular.forEach(ua.products,function(a){a.selected=!1}),ua.product=a,ua.product.selected=!0}function s(){ua.supplierLoading=!0,$.ajax({context:b,type:"GET",url:xa+"supplier_list/",dataType:"json",data:{last_count:ua.suppliers.length},success:function(a){a.suppliers&&(a.suppliers.forEach(function(a){if(ua.suppliers.length){var b=_.findIndex(ua.suppliers,function(b){return b.supplier_uxid==a.supplier_uxid});-1===b?ua.suppliers.push(a):ua.suppliers[b]=a}else ua.suppliers.push(a)}),v()),ua.suppliers.length?ua.supplierEmpty=!1:ua.supplierEmpty=!0,ua.$apply()},complete:function(){ua.supplierLoading=!1,ua.$apply()},error:function(){ua.supplierLoading=!1,ua.$apply()}})}function t(){ua.supplierLoading=!0,$.ajax({context:b,type:"GET",url:xa+"supplier_search/",dataType:"json",data:{last_count:ua.suppliers.length,search:ua.supplierSearch},success:function(a){a.suppliers&&(a.suppliers.forEach(function(a){if(ua.suppliers.length){var b=_.findIndex(ua.suppliers,function(b){return b.supplier_uxid==a.supplier_uxid});-1===b?ua.suppliers.push(a):ua.suppliers[b]=a}else ua.suppliers.push(a)}),v()),ua.suppliers.length?ua.supplierEmpty=!1:ua.supplierEmpty=!0,ua.$apply()},complete:function(){ua.supplierLoading=!1,ua.$apply()},error:function(){ua.supplierLoading=!1,ua.$apply()}})}function u(){var a=!1;return angular.forEach(ua.suppliers,function(b){b.selected&&(a=!0)}),a}function v(){0==u()&&ua.suppliers.length&&y(ua.suppliers[0])}function w(){ua.supplierEmpty=!1,ua.supplierSearch.length?(ua.suppliers=[],t()):(ua.suppliers=[],s())}function x(){ua.supplierEmpty=!1,ua.supplierSearch.length?t():s()}function y(a){angular.forEach(ua.suppliers,function(a){a.selected=!1}),ua.supplier=a,ua.supplier.selected=!0}function z(a){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"supplier_set/",dataType:"json",data:a,success:function(a){ua.supplierSelectForm=!1,ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function A(){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"supplier_clear/",dataType:"json",success:function(a){ua.supplierSelectForm=!1,ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function B(){ua.supplierFormNew=!0}function C(){ua.supplierCreateLoading=!0,$.ajax({context:b,type:"POST",url:xa+"supplier_save/",dataType:"json",data:ua.supplierObjNew,success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.status&&"OK"==a.status&&(ua.supplierObjNew.supplier_uxid="",ua.supplierObjNew.supplier_realname="",ua.supplierObjNew.supplier_code="",ua.supplierObjNew.supplier_email="",ua.supplierObjNew.supplier_company="",ua.supplierObjNew.supplier_phone="",ua.supplierObjNew.supplier_address1="",ua.supplierObjNew.supplier_address2="",ua.supplierObjNew.supplier_address3="",ua.supplierObjNew.supplier_address4="",ua.supplierObjNew.supplier_address5="",w(),ua.supplierFormNew=!1,ua.$apply())},complete:function(){ua.supplierCreateLoading=!1,ua.$apply()},error:function(){ua.supplierCreateLoading=!1,ua.$apply()}})}function D(a){ua.supplierObjEdit.supplier_uxid=a.supplier_uxid,ua.supplierObjEdit.supplier_realname=a.supplier_realname,ua.supplierObjEdit.supplier_code=a.supplier_code,ua.supplierObjEdit.supplier_email=a.supplier_email,ua.supplierObjEdit.supplier_company=a.supplier_company,ua.supplierObjEdit.supplier_phone=a.supplier_phone,ua.supplierObjEdit.supplier_address1=a.supplier_address1,ua.supplierObjEdit.supplier_address2=a.supplier_address2,ua.supplierObjEdit.supplier_address3=a.supplier_address3,ua.supplierObjEdit.supplier_address4=a.supplier_address4,ua.supplierObjEdit.supplier_address5=a.supplier_address5,ua.supplierFormEdit=!0}function E(){ua.supplierEditLoading=!0,$.ajax({context:b,type:"POST",url:xa+"supplier_update/",dataType:"json",data:ua.supplierObjEdit,success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.status&&"OK"==a.status&&(ua.supplierObjEdit.supplier_uxid="",ua.supplierObjEdit.supplier_realname="",ua.supplierObjEdit.supplier_code="",ua.supplierObjEdit.supplier_email="",ua.supplierObjEdit.supplier_company="",ua.supplierObjEdit.supplier_phone="",ua.supplierObjEdit.supplier_address1="",ua.supplierObjEdit.supplier_address2="",ua.supplierObjEdit.supplier_address3="",ua.supplierObjEdit.supplier_address4="",ua.supplierObjEdit.supplier_address5="",w(),ua.supplierFormEdit=!1,ua.$apply())},complete:function(){ua.supplierEditLoading=!1,ua.$apply()},error:function(){ua.supplierEditLoading=!1,ua.$apply()}})}function F(){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"transaction_load/",dataType:"json",success:function(a){ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function G(a){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"transaction_open/",dataType:"json",data:{transaction_uxid:a.transaction_uxid},success:function(a){ua.transactionDraftForm=!1,ua.transactionOkForm=!1,ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function H(a){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"transaction_open/",dataType:"json",data:{transaction_uxid:a},success:function(a){ua.transactionDraftForm=!1,ua.transactionOkForm=!1,ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function I(a){ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"cart_add_product/",dataType:"json",data:a,success:function(b){if(ua.transactionLoading=!1,b.transaction&&(ua.transaction=b.transaction),b.carts&&(ua.carts=b.carts),b.carts){var c=_.findIndex(ua.carts,function(b){return b.cart_product_uxid==a.product_uxid});c>=0&&K(ua.carts[c])}ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function J(){ua.barcodeTx.length&&(ua.transactionLoading=!0,$.ajax({context:b,type:"GET",url:ya+"cart_add_barcode/",dataType:"json",data:{product_code:ua.barcodeTx},success:function(a){if(ua.transactionLoading=!1,a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),a.carts){var b=_.findIndex(ua.carts,function(a){return a.cart_product_code.toUpperCase()==ua.barcodeTx.toUpperCase()});b>=0&&K(ua.carts[b])}ua.barcodeTx="",ua.$apply()},complete:function(){ua.barcodeTx="",ua.transactionLoading=!1,ua.$apply()},error:function(){ua.barcodeTx="",ua.transactionLoading=!1,ua.$apply()}}))}function K(a){ua.cartEditObj.cart_uxid=a.cart_uxid,ua.cartEditObj.cart_product_name=a.cart_product_name,ua.cartEditObj.cart_product_code=a.cart_product_code,ua.cartEditObj.cart_product_unit=a.cart_product_unit,ua.cartEditObj.cart_product_base_price=e(a.cart_product_base_price),ua.cartEditObj.cart_amount=e(a.cart_amount),ua.cartEditObj.cart_base_value=e(a.cart_base_value),ua.cartEditObj.cart_note=a.cart_note,ua.cartEditForm=!0}function L(){ua.cartEditObj.cart_product_base_price=h(ua.cartEditObj.cart_product_base_price),ua.cartEditLoading=!0,$.ajax({context:b,type:"POST",url:ya+"cart_update/",dataType:"json",data:ua.cartEditObj,success:function(a){ua.cartEditForm=!1,ua.cartEditLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),$("#txBarcode").focus(),ua.$apply()},complete:function(){ua.cartEditLoading=!1,ua.$apply()},error:function(){ua.cartEditLoading=!1,ua.$apply()}})}function M(a){ua.cartDeleteConfirm=!0,ua.cartObjDelete.cart_uxid=a.cart_uxid,ua.cartObjDelete.cart_product_name=a.cart_product_name}function N(){ua.cartDeleteLoading=!0,$.ajax({context:b,type:"GET",url:ya+"cart_delete/",dataType:"json",data:ua.cartObjDelete,success:function(a){ua.cartDeleteConfirm=!1,ua.cartDeleteLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.cartDeleteLoading=!1,ua.$apply()},error:function(){ua.cartDeleteLoading=!1,ua.$apply()}})}function O(a){return ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.discountEditObj.discount_value=a.transaction_discount_value>0?a.transaction_discount_value:5,ua.discountEditObj.discount_value=e(ua.discountEditObj.discount_value),void(ua.discountFormEdit=!0))}function P(){ua.discountEditLoading=!0,$.ajax({context:b,type:"POST",url:ya+"discount_update/",dataType:"json",data:ua.discountEditObj,success:function(a){ua.discountFormEdit=!1,ua.discountEditLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.discountEditLoading=!1,ua.$apply()},error:function(){ua.discountEditLoading=!1,ua.$apply()}})}function Q(a){ua.discountDeleteConfirm=!0,ua.discountObjDelete.discount_value=a.transaction_discount_value}function R(){ua.discountDeleteLoading=!0,$.ajax({context:b,type:"GET",url:ya+"discount_delete/",dataType:"json",success:function(a){ua.discountDeleteConfirm=!1,ua.discountDeleteLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.discountDeleteLoading=!1,ua.$apply()},error:function(){ua.discountDeleteLoading=!1,ua.$apply()}})}function S(a){return ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.taxObjEdit.tax_percent=a.transaction_tax_percent>0?a.transaction_tax_percent:10,ua.taxObjEdit.tax_percent=e(ua.taxObjEdit.tax_percent),void(ua.taxFormEdit=!0))}function T(){ua.taxEditLoading=!0,$.ajax({context:b,type:"POST",url:ya+"tax_update/",dataType:"json",data:ua.taxObjEdit,success:function(a){ua.taxFormEdit=!1,ua.taxEditLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.taxEditLoading=!1,ua.$apply()},error:function(){ua.taxEditLoading=!1,ua.$apply()}})}function U(a){ua.taxDeleteConfirm=!0,ua.taxObjDelete.tax_percent=a.transaction_tax_percent}function V(){ua.taxDeleteLoading=!0,$.ajax({context:b,type:"GET",url:ya+"tax_delete/",dataType:"json",success:function(a){ua.taxDeleteConfirm=!1,ua.taxDeleteLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.taxDeleteLoading=!1,ua.$apply()},error:function(){ua.taxDeleteLoading=!1,ua.$apply()}})}function W(a){return ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.shippingObjEdit.shipping_weight=a.transaction_weight,ua.shippingObjEdit.shipping_cost=e(a.transaction_shipping_cost),void(ua.shippingFormEdit=!0))}function X(){ua.shippingEditLoading=!0,$.ajax({context:b,type:"POST",url:ya+"shipping_update/",dataType:"json",data:ua.shippingObjEdit,success:function(a){ua.shippingFormEdit=!1,ua.shippingEditLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.shippingEditLoading=!1,ua.$apply()},error:function(){ua.shippingEditLoading=!1,ua.$apply()}})}function Y(a){ua.shippingDeleteConfirm=!0,ua.shippingObjDelete.shipping_cost=a.transaction_shipping_cost}function Z(){ua.shippingDeleteLoading=!0,$.ajax({context:b,type:"GET",url:ya+"shipping_delete/",dataType:"json",success:function(a){ua.shippingDeleteConfirm=!1,ua.shippingDeleteLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.shippingDeleteLoading=!1,ua.$apply()},error:function(){ua.shippingDeleteLoading=!1,ua.$apply()}})}function aa(a){return ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.draftObj.draft_name=a.transaction_draft_name,void(ua.draftForm=!0))}function ba(){ua.draftSaveLoading=!0,$.ajax({context:b,type:"POST",url:ya+"draft_save/",dataType:"json",data:ua.draftObj,success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.transaction&&(ua.draftForm=!1,ua.draftSaveLoading=!1,ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.draftSaveLoading=!1,ua.$apply()},error:function(){ua.draftSaveLoading=!1,ua.$apply()}})}function ca(){return ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.payTunaiObj.cash_date_start=ua.transaction.transaction_date,ua.payTunaiObj.cash_total=ua.transaction.transaction_total,ua.payTunaiObj.cash_pay=e(ua.transaction.transaction_total),ua.transactionLoading=!0,void $.ajax({context:b,type:"GET",url:za+"cashbox_list/",dataType:"json",success:function(a){ua.transactionLoading=!1,a.cashboxs&&(a.cashboxs.forEach(function(a){if(ua.cashboxs.length){var b=_.findIndex(ua.cashboxs,function(b){return b.cashbox_uxid==a.cashbox_uxid});-1===b?ua.cashboxs.push(a):ua.cashboxs[b]=a}else ua.cashboxs.push(a)}),ua.payTunaiForm=!0,ua.optionCashboxSelected=ua.cashboxs[0]),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}}))}function da(){ua.payTunaiLoading=!0,ua.payTunaiObj.cash_cashbox_uxid=ua.optionCashboxSelected.cashbox_uxid,ua.payTunaiObj.cash_cashbox_name=ua.optionCashboxSelected.cashbox_name,$.ajax({context:b,type:"POST",url:ya+"pay_tunai_save/",dataType:"json",data:ua.payTunaiObj,success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.transaction&&(ua.payTunaiObj.cash_total="",ua.payTunaiObj.cash_pay="",ua.payTunaiObj.cash_cashbox_uxid="",ua.payTunaiObj.cash_cashbox_name="",ua.payTunaiForm=!1,ua.payTunaiLoading=!1,ua.transaction=a.transaction,ta()),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.payTunaiLoading=!1,ua.$apply()},error:function(){ua.payTunaiLoading=!1,ua.$apply()}})}function ea(){return ua.transaction.transaction_supplier_uxid.length<2?void c.pop("info","Info","Silahkan set supplier terlebih dahulu"):ua.transaction.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):(ua.payKreditObj.cash_date_start=ua.transaction.transaction_date,ua.payKreditObj.cash_tempo_day=30,ua.payKreditObj.cash_total=ua.transaction.transaction_total,ua.payKreditObj.cash_pay=0,ua.transactionLoading=!0,void $.ajax({context:b,type:"GET",url:za+"cashbox_list/",dataType:"json",success:function(a){ua.transactionLoading=!1,a.cashboxs&&(a.cashboxs.forEach(function(a){if(ua.cashboxs.length){var b=_.findIndex(ua.cashboxs,function(b){return b.cashbox_uxid==a.cashbox_uxid});-1===b?ua.cashboxs.push(a):ua.cashboxs[b]=a}else ua.cashboxs.push(a)}),ua.payKreditForm=!0,ua.optionCashboxSelected=ua.cashboxs[0]),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}}))}function fa(){ua.payKreditLoading=!0,ua.payKreditObj.cash_cashbox_uxid=ua.optionCashboxSelected.cashbox_uxid,ua.payKreditObj.cash_cashbox_name=ua.optionCashboxSelected.cashbox_name,$.ajax({context:b,type:"POST",url:ya+"pay_kredit_save/",dataType:"json",data:ua.payKreditObj,success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.transaction&&(ua.payKreditObj.cash_total="",ua.payKreditObj.cash_pay="",ua.payKreditObj.cash_cashbox_uxid="",ua.payKreditObj.cash_cashbox_name="",ua.payKreditForm=!1,ua.payKreditLoading=!1,ua.transaction=a.transaction,ta()),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.payKreditLoading=!1,ua.$apply()},error:function(){ua.payKreditLoading=!1,ua.$apply()}})}function ga(){ua.transactionLoading=!0,$.ajax({context:b,type:"POST",url:ya+"date_update/",dataType:"json",data:{transaction_date:ua.transaction.transaction_date},success:function(a){ua.transactionLoading=!1,a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),ua.$apply()},complete:function(){ua.transactionLoading=!1,ua.$apply()},error:function(){ua.transactionLoading=!1,ua.$apply()}})}function ha(){ua.transactionDraftLoading=!0,$.ajax({context:b,type:"GET",url:Aa+"transaction_buy_draft_list/",dataType:"json",data:{last_count:ua.transactionDraftArray.length},success:function(a){ua.transactionDraftLoading=!1,a.transactions&&(a.transactions.forEach(function(a){if(ua.transactionDraftArray.length){var b=_.findIndex(ua.transactionDraftArray,function(b){return b.transaction_uxid==a.transaction_uxid});-1===b?ua.transactionDraftArray.push(a):ua.transactionDraftArray[b]=a}else ua.transactionDraftArray.push(a)}),ja()),ua.transactionDraftArray.length?ua.transactionDraftEmpty=!1:ua.transactionDraftEmpty=!0,ua.$apply()},complete:function(){ua.transactionDraftLoading=!1,ua.$apply()},error:function(){ua.transactionDraftLoading=!1,ua.$apply()}})}function ia(){ua.transactionDraftLoading=!0,$.ajax({context:b,type:"GET",url:Aa+"transaction_buy_draft_search/",dataType:"json",data:{last_count:ua.transactionDraftArray.length,search:ua.transactionDraftSearchTx},success:function(a){ua.transactionDraftLoading=!1,a.transactions&&(a.transactions.forEach(function(a){if(ua.transactionDraftArray.length){var b=_.findIndex(ua.transactionDraftArray,function(b){return b.transaction_uxid==a.transaction_uxid});-1===b?ua.transactionDraftArray.push(a):ua.transactionDraftArray[b]=a}else ua.transactionDraftArray.push(a)}),ja()),ua.transactionDraftArray.length?ua.transactionDraftEmpty=!1:ua.transactionDraftEmpty=!0,ua.$apply()},complete:function(){ua.transactionDraftLoading=!1,ua.$apply()},error:function(){ua.transactionDraftLoading=!1,ua.$apply()}})}function ja(){ua.transactionDraftObjSelect||ua.transactionDraftArray.length&&ma(ua.transactionDraftArray[0])}function ka(){ua.transactionDraftEmpty=!1,ua.transactionDraftSearchTx.length?(ua.transactionDraftArray=[],ia()):(ua.transactionDraftArray=[],ha())}function la(){ua.transactionDraftEmpty=!1,ua.transactionDraftSearchTx.length?ia():ha()}function ma(a){angular.forEach(ua.transactionDraftArray,function(a){a.selected=!1}),ua.transactionDraftObjSelect=a,ua.transactionDraftObjSelect.selected=!0}function na(){ua.transactionOkLoading=!0,$.ajax({context:b,type:"GET",url:Aa+"transaction_buy_ok_list/",dataType:"json",data:{last_count:ua.transactionOkArray.length},success:function(a){ua.transactionOkLoading=!1,a.transactions&&(a.transactions.forEach(function(a){if(ua.transactionOkArray.length){var b=_.findIndex(ua.transactionOkArray,function(b){return b.transaction_uxid==a.transaction_uxid});-1===b?ua.transactionOkArray.push(a):ua.transactionOkArray[b]=a}else ua.transactionOkArray.push(a)}),pa()),ua.transactionOkArray.length?ua.transactionOkEmpty=!1:ua.transactionOkEmpty=!0,ua.$apply()},complete:function(){ua.transactionOkLoading=!1,ua.$apply()},error:function(){ua.transactionOkLoading=!1,ua.$apply()}})}function oa(){ua.transactionOkLoading=!0,$.ajax({context:b,type:"GET",url:Aa+"transaction_buy_ok_search/",dataType:"json",data:{last_count:ua.transactionOkArray.length,search:ua.transactionOkSearchTx},success:function(a){ua.transactionOkLoading=!1,a.transactions&&(a.transactions.forEach(function(a){if(ua.transactionOkArray.length){var b=_.findIndex(ua.transactionOkArray,function(b){return b.transaction_uxid==a.transaction_uxid});-1===b?ua.transactionOkArray.push(a):ua.transactionOkArray[b]=a}else ua.transactionOkArray.push(a)}),pa()),ua.transactionOkArray.length?ua.transactionOkEmpty=!1:ua.transactionOkEmpty=!0,ua.$apply()},complete:function(){ua.transactionOkLoading=!1,ua.$apply()},error:function(){ua.transactionOkLoading=!1,ua.$apply()}})}function pa(){ua.transactionOkObjSelect||ua.transactionOkArray.length&&sa(ua.transactionOkArray[0])}function qa(){ua.transactionOkEmpty=!1,ua.transactionOkSearchTx.length?(ua.transactionOkArray=[],oa()):(ua.transactionOkArray=[],na())}function ra(){ua.transactionOkEmpty=!1,ua.transactionOkSearchTx.length?oa():na()}function sa(a){angular.forEach(ua.transactionOkArray,function(a){a.selected=!1}),ua.transactionOkObjSelect=a,ua.transactionOkObjSelect.selected=!0}function ta(){ua.transactionFinishConfirm=!0}var ua=b;ua.loadComplete=!1,ua.windowHeight=function(){var a=$(window).height(),b=a/4,c=a-b;return c-80},ua.formatNumber=e,ua.toRealNumber=f,ua.removeZeroDecimal=g;var va=a.api.url_product,wa=a.api.url_product_image_host;ua.api_url_product_image_host=wa,ua.productSelectForm=!1,ua.productSelectFormOpen=function(){ua.productSelectForm=!0,l()},ua.categoryLoading=!1,ua.categorys=[],i(),ua.categoryListMore=function(){i()},ua.categoryNameSelected="",ua.categorySelect=j,ua.categoryClearSelect=k,b.$watch("categoryNameSelected",function(a,b){(void 0!==a||null!==a)&&a!==b&&l()},!0),ua.productListLoad=l,ua.productListMoreCall=function(){m()},ua.productLoading=!1,ua.products=[],ua.productList=n,ua.productSearch="",ua.productSelect=r;var xa=a.api.url_supplier;ua.supplierSelectForm=!1,ua.supplierSelectFormOpen=function(){ua.supplierSelectForm=!0,w()},ua.supplierEmpty=!1,ua.supplierLoading=!1,ua.suppliers=[],ua.supplierSearch="",ua.supplierListLoad=w,ua.supplierListMoreCall=function(){x()},ua.supplierSelect=y,ua.supplierSetSave=z,ua.supplierClearSave=A,ua.supplierObjNew={supplier_uxid:"",supplier_realname:"",supplier_code:"",supplier_email:"",supplier_company:"",supplier_phone:"",supplier_address1:"",supplier_address2:"",supplier_address3:"",supplier_address4:"",supplier_address5:""},ua.supplierFormNew=!1,ua.supplierCreate=B,ua.supplierCreateLoading=!1,ua.supplierCreateSave=C,ua.supplierObjEdit={supplier_uxid:"",supplier_realname:"",supplier_code:"",supplier_email:"",supplier_company:"",supplier_phone:"",supplier_address1:"",supplier_address2:"",supplier_address3:"",supplier_address4:"",supplier_address5:""},ua.supplierFormEdit=!1,ua.supplierEdit=D,ua.supplierEditLoading=!1,ua.supplierEditSave=E;var ya=a.api.url_transaction_buy;ua.transaction={transaction_uxid:"",transaction_number:"",transaction_draft_name:"",transaction_operator_uxid:"",transaction_operator_username:"",transaction_supplier_uxid:"",transaction_supplier_realname:"",transaction_supplier_code:"",transaction_supplier_email:"",transaction_supplier_company:"",transaction_supplier_phone:"",transaction_supplier_address1:"",transaction_supplier_address2:"",transaction_supplier_address3:"",transaction_supplier_address4:"",transaction_supplier_address5:"",transaction_supplier_uxid:"",transaction_supplier_realname:"",transaction_supplier_code:"",transaction_supplier_email:"",transaction_supplier_company:"",transaction_supplier_phone:"",transaction_supplier_address1:"",transaction_supplier_address2:"",transaction_supplier_address3:"",transaction_supplier_address4:"",transaction_supplier_address5:"",transaction_shipping_realname:"",transaction_shipping_code:"",transaction_shipping_email:"",transaction_shipping_company:"",transaction_shipping_phone:"",transaction_shipping_address1:"",transaction_shipping_address2:"",transaction_shipping_address3:"",transaction_shipping_address4:"",transaction_shipping_address5:"",transaction_shipping_cost:"",transaction_value:"",transaction_weight:"",transaction_tax_percent:"",transaction_tax_value:"",transaction_total:"",transaction_cash_pay:"",transaction_cash_back:"",transaction_day:"",transaction_month:"",transaction_year:"",transaction_timestamp:"",transaction_terms:"",transaction_note:"",transaction_status:"",transaction_discount_value:"",transaction_discount_price:"",transaction_date:""},b.$watch("transaction",function(a,b){(void 0!==a||null!==a)&&ua.transaction.transaction_uxid.length>1&&(ua.loadComplete=!0)},!0),ua.transactionLoading=!1,ua.carts=[],ua.transactionOpen=G,ua.cartAddProduct=I,ua.barcodeTx="",ua.cartAddBarcode=J,ua.cartEditObj={cart_uxid:"",cart_product_name:"",cart_product_code:"",cart_product_unit:"",cart_product_base_price:"",cart_amount:"",cart_base_value:"",cart_note:""},ua.cartEditForm=!1,ua.cartEdit=K,b.$watch("cartEditObj.cart_product_base_price",function(a,b){if(void 0!==a&&null!==a){var c=f(ua.cartEditObj.cart_amount),d=f(a);if(c>0&&d>0){var g=f(ua.cartEditObj.cart_product_base_price)*f(ua.cartEditObj.cart_amount);ua.cartEditObj.cart_base_value=e(g)}}},!0),b.$watch("cartEditObj.cart_amount",function(a,b){if(void 0!==a&&null!==a){var c=f(ua.cartEditObj.cart_amount),d=f(ua.cartEditObj.cart_product_base_price);if(c>0&&d>0){var g=f(ua.cartEditObj.cart_product_base_price)*f(ua.cartEditObj.cart_amount);ua.cartEditObj.cart_base_value=e(g)}}},!0),b.$watch("cartEditObj.cart_base_value",function(a,b){if(void 0!==a&&null!==a){var c=f(ua.cartEditObj.cart_amount),d=f(a);if(c>0&&d>0){var g=f(ua.cartEditObj.cart_base_value)/f(ua.cartEditObj.cart_amount);ua.cartEditObj.cart_product_base_price=e(g)}}},!0),$("#txBarcode").focus(),ua.cartEditLoading=!1,ua.cartEditSave=L,ua.cartObjDelete={cart_uxid:"",cart_product_name:""},ua.cartDeleteConfirm=!1,ua.cartDelete=M,ua.cartDeleteLoading=!1,ua.cartDeleteYes=N,ua.discountEditObj={discount_value:""},ua.discountFormEdit=!1,ua.discountEdit=O,ua.discountEditLoading=!1,ua.discountEditSave=P,ua.discountObjDelete={discount_value:""},ua.discountDeleteConfirm=!1,ua.discountDelete=Q,ua.discountDeleteLoading=!1,ua.discountDeleteYes=R,ua.taxObjEdit={tax_percent:""},ua.taxFormEdit=!1,ua.taxEdit=S,ua.taxEditLoading=!1,ua.taxEditSave=T,ua.taxObjDelete={tax_percent:""},ua.taxDeleteConfirm=!1,ua.taxDelete=U,ua.taxDeleteLoading=!1,ua.taxDeleteYes=V,ua.shippingObjEdit={shipping_weight:"",shipping_cost:""},ua.shippingFormEdit=!1,ua.shippingEdit=W,ua.shippingEditLoading=!1,ua.shippingEditSave=X,ua.shippingObjDelete={shipping_cost:""},ua.shippingDeleteConfirm=!1,ua.shippingDelete=Y,ua.shippingDeleteLoading=!1,ua.shippingDeleteYes=Z,ua.draftObj={draft_name:""},ua.draftForm=!1,ua.draftFormOpen=aa,ua.draftSaveLoading=!1,ua.draftSave=ba;var za=a.api.url_cashflow;ua.payTunaiObj={cash_date_start:"",cash_total:"",cash_pay:"",cash_cashbox_uxid:"",cash_cashbox_name:""},ua.payTunaiForm=!1,ua.cashboxs=[],ua.payTunai=ca,ua.payTunaiLoading=!1,ua.payTunaiSave=da,ua.payKreditObj={cash_date_start:"",cash_tempo_day:30,cash_total:"",cash_pay:"",cash_cashbox_uxid:"",cash_cashbox_name:""},ua.payKreditForm=!1,ua.cashboxs=[],ua.payKredit=ea,ua.payKreditLoading=!1,ua.payKreditSave=fa,ua.dateSave=ga,b.$watch("transaction.transaction_date",function(a,b){if((void 0!==a||null!==a)&&b.length){
var c=b.replace(" ","-");c!=a&&(console.log(a),a.indexOf("-")>=0&&ga())}},!0),ua.isTunai=!0,b.$watch("transaction.transaction_cash_back",function(a,b){(void 0!==a||null!==a)&&(0>a?ua.isTunai=!1:ua.isTunai=!0)},!0);var Aa=a.api.url_transaction;ua.transactionDraftForm=!1,ua.transactionDraftFormOpen=function(){ua.transactionDraftForm=!0,ka()},ua.transactionDraftEmpty=!1,ua.transactionDraftLoading=!1,ua.transactionDraftArray=[],ua.transactionDraftList=ha,ua.transactionDraftSearchTx="",ua.transactionDraftListLoad=ka,ua.transactionDraftListMoreCall=function(){la()},ua.transactionDraftSelect=ma,ua.transactionOkForm=!1,ua.transactionOkFormOpen=function(){ua.transactionOkForm=!0,qa()},ua.transactionOkEmpty=!1,ua.transactionOkLoading=!1,ua.transactionOkArray=[],ua.transactionOkList=na,ua.transactionOkSearchTx="",ua.transactionOkListLoad=qa,ua.transactionOkListMoreCall=function(){ra()},ua.transactionOkObjSelect=!1,ua.transactionOkSelect=sa,ua.transactionCancelConfirm=!1,ua.transactionCancel=function(){ua.transactionCancelConfirm=!0},ua.transactionCloseConfirm=!1,ua.transactionClose=function(){ua.transactionCloseConfirm=!0},ua.transactionCloseLoading=!1,ua.transactionCloseYes=function(){ua.transactionCloseLoading=!0,$.ajax({context:b,type:"GET",url:ya+"transaction_close/",dataType:"json",success:function(a){ua.transactionCancelConfirm=!1,ua.transactionCloseConfirm=!1,ua.transactionFinishConfirm=!1,ua.transactionCloseLoading=!1,ua.carts=[],a.transaction&&(ua.transaction=a.transaction),a.carts&&(ua.carts=a.carts),d.go("app.buy"),ua.$apply()},complete:function(){ua.transactionCancelConfirm=!1,ua.transactionCloseConfirm=!1,ua.transactionFinishConfirm=!1,ua.transactionCloseLoading=!1,ua.$apply()},error:function(){ua.transactionCancelConfirm=!1,ua.transactionCloseConfirm=!1,ua.transactionFinishConfirm=!1,ua.transactionCloseLoading=!1,ua.$apply()}})},ua.transactionObjDelete={transaction_uxid:"",transaction_number:""},ua.transactionDeleteConfirm=!1,ua.transactionDelete=function(a){ua.transactionDeleteConfirm=!0,ua.transactionObjDelete.transaction_uxid=a.transaction_uxid,ua.transactionObjDelete.transaction_number=a.transaction_number},ua.transactionDeleteLoading=!1,ua.transactionDeleteYes=function(){ua.transactionDeleteLoading=!0,$.ajax({context:b,type:"GET",url:ya+"transaction_delete/",dataType:"json",data:ua.transactionObjDelete,success:function(a){ua.transactionDeleteLoading=!1,a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),ua.$apply()),a.status&&"OK"==a.status&&(ua.transactionDeleteConfirm=!1,ua.transactionOkObjSelect=!1,ua.transactionOkArray=_.without(ua.transactionOkArray,_.findWhere(ua.transactionOkArray,{transaction_uxid:ua.transactionObjDelete.transaction_uxid})),pa()),ua.$apply()},complete:function(){ua.transactionDeleteLoading=!1,ua.$apply()},error:function(){ua.transactionDeleteLoading=!1,ua.$apply()}})},ua.transactionFinishConfirm=!1,ua.transactionFinishOpen=ta,d.params.uxid?H(d.params.uxid):F(),ua.transactionPrintBT=function(a){return a.transaction_total<=0?void c.pop("info","Info","Belum ada daftar belanja"):void $.ajax({context:b,type:"GET",url:"/print/transaction/",dataType:"json",data:{transaction_uxid:a.transaction_uxid},success:function(a){a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message)),ua.$apply()},complete:function(){},error:function(){}})},ua.printDiv=function(a){if(ua.transaction.transaction_total<=0)return void c.pop("info","Info","Belum ada daftar belanja");var b=document.getElementById(a).innerHTML;document.body.innerHTML;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var d=window.open("","_blank","width=600,height=600,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no");d.window.focus(),d.document.write('<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="www/assets/styles/nota.css" /></head><body onload="window.print()"><div class="reward-body">'+b+"</div></html>"),d.onbeforeunload=function(a){return d.close(),".\n"},d.onabort=function(a){d.document.close(),d.close()}}else{var d=window.open("","_blank","width=800,height=600");d.document.open(),d.document.write('<html><head><link rel="stylesheet" type="text/css" href="www/assets/styles/nota.css" /></head><body onload="window.print()">'+b+"</html>"),d.document.close()}return!0}}angular.module("app",["datetimepicker"]).controller("BuyCtrl",a),a.$inject=["$rootScope","$scope","toaster","$state"]}();