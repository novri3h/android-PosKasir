!function(){"use strict";function a(a,b,c){function d(){r.supplierLoading=!0,$.ajax({context:b,type:"GET",url:q+"supplier_list/",dataType:"json",data:{last_count:r.suppliers.length},success:function(a){r.supplierLoading=!1,a.suppliers&&(a.suppliers.forEach(function(a){if(r.suppliers.length){var b=_.findIndex(r.suppliers,function(b){return b.supplier_uxid==a.supplier_uxid});-1===b?r.suppliers.push(a):r.suppliers[b]=a}else r.suppliers.push(a)}),g()),r.suppliers.length?r.supplierEmpty=!1:r.supplierEmpty=!0,r.$apply()},complete:function(){r.supplierLoading=!1,r.$apply()},error:function(){r.supplierLoading=!1,r.$apply()}})}function e(){r.supplierLoading=!0,$.ajax({context:b,type:"GET",url:q+"supplier_search/",dataType:"json",data:{last_count:r.suppliers.length,search:r.supplierSearch},success:function(a){r.supplierLoading=!1,a.suppliers&&(a.suppliers.forEach(function(a){if(r.suppliers.length){var b=_.findIndex(r.suppliers,function(b){return b.supplier_uxid==a.supplier_uxid});-1===b?r.suppliers.push(a):r.suppliers[b]=a}else r.suppliers.push(a)}),g()),r.suppliers.length?r.supplierEmpty=!1:r.supplierEmpty=!0,r.$apply()},complete:function(){r.supplierLoading=!1,r.$apply()},error:function(){r.supplierLoading=!1,r.$apply()}})}function f(){var a=!1;return angular.forEach(r.suppliers,function(b){b.supplier_code==r.selectedCode&&(r.supplier=b,r.supplier.selected=!0,a=!0,r.selectedCode=""),b.selected&&(a=!0)}),a}function g(){0==f()&&r.suppliers.length&&j(r.suppliers[0])}function h(){r.supplierEmpty=!1,r.supplierSearch.length?(r.suppliers=[],e()):(r.suppliers=[],d())}function i(){r.supplierEmpty=!1,r.supplierSearch.length?e():d()}function j(a){angular.forEach(r.suppliers,function(a){a.selected=!1}),r.supplier=a,r.supplier.selected=!0}function k(){r.supplierFormNew=!0}function l(){r.supplierCreateLoading=!0,$.ajax({context:b,type:"POST",url:q+"supplier_save/",dataType:"json",data:r.supplierObjNew,success:function(a){r.selectedCode=r.supplierObjNew.supplier_code,a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),r.$apply()),a.status&&"OK"==a.status&&(r.supplierObjNew.supplier_uxid="",r.supplierObjNew.supplier_realname="",r.supplierObjNew.supplier_code="",r.supplierObjNew.supplier_email="",r.supplierObjNew.supplier_company="",r.supplierObjNew.supplier_phone="",r.supplierObjNew.supplier_address1="",r.supplierObjNew.supplier_address2="",r.supplierObjNew.supplier_address3="",r.supplierObjNew.supplier_address4="",r.supplierObjNew.supplier_address5="",h(),r.supplierFormNew=!1,r.$apply())},complete:function(){r.supplierCreateLoading=!1,r.$apply()},error:function(){r.supplierCreateLoading=!1,r.$apply()}})}function m(a){r.supplierObjEdit.supplier_uxid=a.supplier_uxid,r.supplierObjEdit.supplier_realname=a.supplier_realname,r.supplierObjEdit.supplier_code=a.supplier_code,r.supplierObjEdit.supplier_email=a.supplier_email,r.supplierObjEdit.supplier_company=a.supplier_company,r.supplierObjEdit.supplier_phone=a.supplier_phone,r.supplierObjEdit.supplier_address1=a.supplier_address1,r.supplierObjEdit.supplier_address2=a.supplier_address2,r.supplierObjEdit.supplier_address3=a.supplier_address3,r.supplierObjEdit.supplier_address4=a.supplier_address4,r.supplierObjEdit.supplier_address5=a.supplier_address5,r.supplierFormEdit=!0}function n(){r.supplierEditLoading=!0,$.ajax({context:b,type:"POST",url:q+"supplier_update/",dataType:"json",data:r.supplierObjEdit,success:function(a){r.selectedCode=r.supplierObjEdit.supplier_code,a.message&&(a.status?"OK"==a.status?c.pop("success","Info",a.message):c.pop("error","Error",a.message):c.pop("info","Message",a.message),r.$apply()),a.status&&"OK"==a.status&&(r.supplierObjEdit.supplier_uxid="",r.supplierObjEdit.supplier_realname="",r.supplierObjEdit.supplier_code="",r.supplierObjEdit.supplier_email="",r.supplierObjEdit.supplier_company="",r.supplierObjEdit.supplier_phone="",r.supplierObjEdit.supplier_address1="",r.supplierObjEdit.supplier_address2="",r.supplierObjEdit.supplier_address3="",r.supplierObjEdit.supplier_address4="",r.supplierObjEdit.supplier_address5="",h(),r.supplierFormEdit=!1,r.$apply())},complete:function(){r.supplierEditLoading=!1,r.$apply()},error:function(){r.supplierEditLoading=!1,r.$apply()}})}function o(a){r.supplierDeleteConfirm=!0,r.supplierObjDelete.supplier_uxid=a.supplier_uxid,r.supplierObjDelete.supplier_realname=a.supplier_realname,r.supplierObjDelete.supplier_code=a.supplier_code}function p(){r.supplierDeleteLoading=!0,$.ajax({context:b,type:"GET",url:q+"supplier_delete/",dataType:"json",data:r.supplierObjDelete,success:function(a){a.status&&"OK"==a.status&&(r.suppliers=_.reject(r.suppliers,function(a){return a.supplier_uxid==r.supplierObjDelete.supplier_uxid}),g(),r.supplierDeleteConfirm=!1,r.suppliers.length?r.supplierEmpty=!1:r.supplierEmpty=!0,r.$apply())},complete:function(){r.supplierDeleteLoading=!1,r.$apply()},error:function(){r.supplierDeleteLoading=!1,r.$apply()}})}var q=a.api.url_supplier,r=b;r.windowHeight=function(){var a=$(window).height(),b=a/4,c=a-b;return c-80},r.supplierEmpty=!1,r.supplierLoading=!1,r.suppliers=[],d(),r.supplierList=d,r.selectedCode="",r.supplierSearch="",r.supplierListLoad=h,r.supplierListMoreCall=function(){i()},r.supplierSelect=j,r.supplierObjNew={supplier_uxid:"",supplier_realname:"",supplier_code:"",supplier_email:"",supplier_company:"",supplier_phone:"",supplier_address1:"",supplier_address2:"",supplier_address3:"",supplier_address4:"",supplier_address5:""},r.supplierFormNew=!1,r.supplierCreate=k,r.supplierCreateLoading=!1,r.supplierCreateSave=l,r.supplierObjEdit={supplier_uxid:"",supplier_realname:"",supplier_code:"",supplier_email:"",supplier_company:"",supplier_phone:"",supplier_address1:"",supplier_address2:"",supplier_address3:"",supplier_address4:"",supplier_address5:""},r.supplierFormEdit=!1,r.supplierEdit=m,r.supplierEditLoading=!1,r.supplierEditSave=n,r.supplierObjDelete={supplier_uxid:"",supplier_realname:"",supplier_code:"",supplier_email:"",supplier_company:"",supplier_phone:"",supplier_address1:"",supplier_address2:"",supplier_address3:"",supplier_address4:"",supplier_address5:""},r.supplierDeleteConfirm=!1,r.supplierDelete=o,r.supplierDeleteLoading=!1,r.supplierDeleteYes=p}angular.module("app").controller("SupplierCtrl",a),a.$inject=["$rootScope","$scope","toaster"]}();